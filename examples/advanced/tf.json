{"format_version":"1.2","terraform_version":"1.12.0","planned_values":{"outputs":{"waf_arns":{"sensitive":false}},"root_module":{"child_modules":[{"resources":[{"address":"module.waf.aws_wafv2_regex_pattern_set.regex_pattern[\"payment-gateway-BlockSuspiciousURIs\"]","mode":"managed","type":"aws_wafv2_regex_pattern_set","name":"regex_pattern","index":"payment-gateway-BlockSuspiciousURIs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"pragma-payment-prod-pattern-BlockSuspiciousURIs","regular_expression":[{"regex_string":".*/wp-admin/.*"},{"regex_string":".*\\.aspx$"},{"regex_string":".*\\.php$"}],"scope":"REGIONAL","tags":null},"sensitive_values":{"regular_expression":[{},{},{}],"tags_all":{}}},{"address":"module.waf.aws_wafv2_web_acl.waf[\"admin-portal\"]","mode":"managed","type":"aws_wafv2_web_acl","name":"waf","index":"admin-portal","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":"WAF for Admin Portal","name":"pragma-payment-prod-waf-admin-portal","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"GeoAllowOnlyColombia","override_action":[],"priority":2,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":["CO"],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-GeoAllowOnlyColombia","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"StrictRateLimit","override_action":[],"priority":3,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","custom_key":[],"evaluation_window_sec":300,"forwarded_ip_config":[],"limit":100,"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-StrictRateLimit","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":0,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"REGIONAL","tags":{"application":"admin-portal","name":"pragma-payment-prod-waf-admin-portal"},"tags_all":{"application":"admin-portal","name":"pragma-payment-prod-waf-admin-portal"},"token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-waf-log-admin-portal","sampled_requests_enabled":true}]},"sensitive_values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}},{"address":"module.waf.aws_wafv2_web_acl.waf[\"payment-gateway\"]","mode":"managed","type":"aws_wafv2_web_acl","name":"waf","index":"payment-gateway","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":"WAF for Payment Gateway API","name":"pragma-payment-prod-waf-payment-gateway","rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"BlockSuspiciousURIs","override_action":[],"priority":7,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[{}]}],"text_transformation":[{"priority":1,"type":"URL_DECODE"},{"priority":2,"type":"LOWERCASE"}]}],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-BlockSuspiciousURIs","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"BlockSuspiciousUserAgents","override_action":[],"priority":6,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[{"name":"user-agent"}],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"positional_constraint":"CONTAINS","search_string":"suspicious-bot","text_transformation":[{"priority":1,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-BlockSuspiciousUserAgents","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"CustomSQLiProtection","override_action":[],"priority":3,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[{"field_to_match":[{"all_query_arguments":[{}],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"sensitivity_level":"","text_transformation":[{"priority":1,"type":"URL_DECODE"},{"priority":2,"type":"HTML_ENTITY_DECODE"}]}],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-CustomSQLiProtection","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"GeoBlockHighRiskCountries","override_action":[],"priority":4,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":["RU","CN","IR","KP","VE"],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-GeoBlockHighRiskCountries","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"RateLimitAPIEndpoints","override_action":[],"priority":5,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","custom_key":[],"evaluation_window_sec":300,"forwarded_ip_config":[],"limit":2000,"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-RateLimitAPIEndpoints","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":0,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesSQLiRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":2,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesSQLiRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesSQLiRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"REGIONAL","tags":{"application":"payment-gateway","name":"pragma-payment-prod-waf-payment-gateway"},"tags_all":{"application":"payment-gateway","name":"pragma-payment-prod-waf-payment-gateway"},"token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-waf-log-payment-gateway","sampled_requests_enabled":true}]},"sensitive_values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[{"field_to_match":[{"all_query_arguments":[{}],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{},{}]}],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false,false,false,false,false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}],"address":"module.waf"}]}},"resource_changes":[{"address":"module.waf.aws_wafv2_regex_pattern_set.regex_pattern[\"payment-gateway-BlockSuspiciousURIs\"]","module_address":"module.waf","mode":"managed","type":"aws_wafv2_regex_pattern_set","name":"regex_pattern","index":"payment-gateway-BlockSuspiciousURIs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"pragma-payment-prod-pattern-BlockSuspiciousURIs","regular_expression":[{"regex_string":".*/wp-admin/.*"},{"regex_string":".*\\.aspx$"},{"regex_string":".*\\.php$"}],"scope":"REGIONAL","tags":null},"after_unknown":{"arn":true,"id":true,"lock_token":true,"name_prefix":true,"regular_expression":[{},{},{}],"tags_all":true},"before_sensitive":false,"after_sensitive":{"regular_expression":[{},{},{}],"tags_all":{}}}},{"address":"module.waf.aws_wafv2_web_acl.waf[\"admin-portal\"]","module_address":"module.waf","mode":"managed","type":"aws_wafv2_web_acl","name":"waf","index":"admin-portal","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":"WAF for Admin Portal","name":"pragma-payment-prod-waf-admin-portal","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"GeoAllowOnlyColombia","override_action":[],"priority":2,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":["CO"],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-GeoAllowOnlyColombia","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"StrictRateLimit","override_action":[],"priority":3,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","custom_key":[],"evaluation_window_sec":300,"forwarded_ip_config":[],"limit":100,"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-StrictRateLimit","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":0,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"REGIONAL","tags":{"application":"admin-portal","name":"pragma-payment-prod-waf-admin-portal"},"tags_all":{"application":"admin-portal","name":"pragma-payment-prod-waf-admin-portal"},"token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-waf-log-admin-portal","sampled_requests_enabled":true}]},"after_unknown":{"application_integration_url":true,"arn":true,"association_config":[],"capacity":true,"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"id":true,"lock_token":true,"name_prefix":true,"rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]},"before_sensitive":false,"after_sensitive":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}},{"address":"module.waf.aws_wafv2_web_acl.waf[\"payment-gateway\"]","module_address":"module.waf","mode":"managed","type":"aws_wafv2_web_acl","name":"waf","index":"payment-gateway","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":"WAF for Payment Gateway API","name":"pragma-payment-prod-waf-payment-gateway","rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"BlockSuspiciousURIs","override_action":[],"priority":7,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[{}]}],"text_transformation":[{"priority":1,"type":"URL_DECODE"},{"priority":2,"type":"LOWERCASE"}]}],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-BlockSuspiciousURIs","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"BlockSuspiciousUserAgents","override_action":[],"priority":6,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[{"name":"user-agent"}],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"positional_constraint":"CONTAINS","search_string":"suspicious-bot","text_transformation":[{"priority":1,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-BlockSuspiciousUserAgents","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"CustomSQLiProtection","override_action":[],"priority":3,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[{"field_to_match":[{"all_query_arguments":[{}],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"sensitivity_level":"","text_transformation":[{"priority":1,"type":"URL_DECODE"},{"priority":2,"type":"HTML_ENTITY_DECODE"}]}],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-CustomSQLiProtection","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"GeoBlockHighRiskCountries","override_action":[],"priority":4,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":["RU","CN","IR","KP","VE"],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-GeoBlockHighRiskCountries","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"name":"RateLimitAPIEndpoints","override_action":[],"priority":5,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","custom_key":[],"evaluation_window_sec":300,"forwarded_ip_config":[],"limit":2000,"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-RateLimitAPIEndpoints","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":0,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]},{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesSQLiRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":2,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesSQLiRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-rule-log-AWSManagedRulesSQLiRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"REGIONAL","tags":{"application":"payment-gateway","name":"pragma-payment-prod-waf-payment-gateway"},"tags_all":{"application":"payment-gateway","name":"pragma-payment-prod-waf-payment-gateway"},"token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"pragma-payment-prod-waf-log-payment-gateway","sampled_requests_enabled":true}]},"after_unknown":{"application_integration_url":true,"arn":true,"association_config":[],"capacity":true,"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"id":true,"lock_token":true,"name_prefix":true,"rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[{"arn":true,"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[{"field_to_match":[{"all_query_arguments":[{}],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{},{}]}],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false,false,false,false,false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]},"before_sensitive":false,"after_sensitive":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"data_protection_config":[],"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[{"field_to_match":[{"all_query_arguments":[{}],"body":[],"cookies":[],"header_order":[],"headers":[],"ja3_fingerprint":[],"ja4_fingerprint":[],"json_body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_fragment":[],"uri_path":[]}],"text_transformation":[{},{}]}],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[{"country_codes":[false,false,false,false,false],"forwarded_ip_config":[]}],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"captcha":[],"challenge":[],"count":[]}],"captcha_config":[],"challenge_config":[],"override_action":[],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"custom_key":[],"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}}],"output_changes":{"waf_arns":{"actions":["create"],"before":null,"after":{"admin-portal":{},"payment-gateway":{}},"after_unknown":{"admin-portal":{"waf_arn":true},"payment-gateway":{"waf_arn":true}},"before_sensitive":false,"after_sensitive":false}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.96.0","expressions":{"region":{"constant_value":"us-east-1"}}},"aws.project":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","alias":"project","version_constraint":"\u003e= 5.96.0","expressions":{"default_tags":[{"tags":{"references":["var.common_tags"]}}],"profile":{"references":["var.profile"]},"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"waf_arns":{"expression":{"references":["module.waf.waf_info","module.waf"]},"description":"ARNs of the created WAF Web ACLs"}},"module_calls":{"waf":{"source":"../../","expressions":{"client":{"constant_value":"pragma"},"environment":{"constant_value":"prod"},"functionality":{"constant_value":"payment"},"waf_config":{"constant_value":[{"application":"payment-gateway","cloudwatch_metrics_enabled":true,"default_allow":false,"description":"WAF for Payment Gateway API","rules":[{"allow":false,"cloudwatch_metrics_enabled":true,"name":"AWSManagedRulesCommonRuleSet","priority":0,"sampled_requests_enabled":true,"statement":{"managed_rule_group_statement":{"rule_name":"AWSManagedRulesCommonRuleSet","vendor_name":"AWS"}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"AWSManagedRulesKnownBadInputsRuleSet","priority":1,"sampled_requests_enabled":true,"statement":{"managed_rule_group_statement":{"rule_name":"AWSManagedRulesKnownBadInputsRuleSet","vendor_name":"AWS"}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"AWSManagedRulesSQLiRuleSet","priority":2,"sampled_requests_enabled":true,"statement":{"managed_rule_group_statement":{"rule_name":"AWSManagedRulesSQLiRuleSet","vendor_name":"AWS"}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"CustomSQLiProtection","priority":3,"sampled_requests_enabled":true,"statement":{"sqli_match_statement":{"all_query_match":true,"text_transformations":["URL_DECODE","HTML_ENTITY_DECODE"]}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"GeoBlockHighRiskCountries","priority":4,"sampled_requests_enabled":true,"statement":{"geo_match_statement":{"country_codes":["RU","CN","IR","KP","VE"]}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"RateLimitAPIEndpoints","priority":5,"sampled_requests_enabled":true,"statement":{"rate_based_statement":{"aggregate_key_type":"IP","evaluation_window_sec":300,"limit":2000}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"BlockSuspiciousUserAgents","priority":6,"sampled_requests_enabled":true,"statement":{"byte_match_statement":{"field_to_match":{"single_header":"user-agent"},"positional_constraint":"CONTAINS","search_string":"suspicious-bot","text_transformations":["LOWERCASE"]}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"BlockSuspiciousURIs","priority":7,"sampled_requests_enabled":true,"statement":{"regex_pattern":{"field_to_match":{"uri_path":true},"regex_strings":[".*\\.php$",".*\\.aspx$",".*/wp-admin/.*"],"text_transformations":["URL_DECODE","LOWERCASE"]}}}],"sampled_requests_enabled":true,"scope":"REGIONAL"},{"application":"admin-portal","cloudwatch_metrics_enabled":true,"default_allow":false,"description":"WAF for Admin Portal","rules":[{"allow":false,"cloudwatch_metrics_enabled":true,"name":"AWSManagedRulesCommonRuleSet","priority":0,"sampled_requests_enabled":true,"statement":{"managed_rule_group_statement":{"rule_name":"AWSManagedRulesCommonRuleSet","vendor_name":"AWS"}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"AWSManagedRulesKnownBadInputsRuleSet","priority":1,"sampled_requests_enabled":true,"statement":{"managed_rule_group_statement":{"rule_name":"AWSManagedRulesKnownBadInputsRuleSet","vendor_name":"AWS"}}},{"allow":true,"cloudwatch_metrics_enabled":true,"name":"GeoAllowOnlyColombia","priority":2,"sampled_requests_enabled":true,"statement":{"geo_match_statement":{"country_codes":["CO"]}}},{"allow":false,"cloudwatch_metrics_enabled":true,"name":"StrictRateLimit","priority":3,"sampled_requests_enabled":true,"statement":{"rate_based_statement":{"aggregate_key_type":"IP","evaluation_window_sec":300,"limit":100}}}],"sampled_requests_enabled":true,"scope":"REGIONAL"}]}},"module":{"outputs":{"waf_info":{"expression":{"references":["aws_wafv2_web_acl.waf"]}}},"resources":[{"address":"aws_wafv2_ip_set.ip_set","mode":"managed","type":"aws_wafv2_ip_set","name":"ip_set","provider_config_key":"aws","expressions":{"addresses":{"constant_value":[]},"description":{"references":["each.value[\"ip_set\"].description","each.value[\"ip_set\"]","each.value"]},"ip_address_version":{"references":["each.value[\"ip_set\"].ip_address_version","each.value[\"ip_set\"]","each.value"]},"name":{"references":["var.client","var.functionality","var.environment","each.value[\"rule_name\"]","each.value"]},"scope":{"references":["each.value[\"ip_set\"].scope","each.value[\"ip_set\"]","each.value"]},"tags":{"references":["var.client","var.functionality","var.environment","each.value[\"rule_name\"]","each.value","each.value.application","each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.waf_config"]}},{"address":"aws_wafv2_regex_pattern_set.regex_pattern","mode":"managed","type":"aws_wafv2_regex_pattern_set","name":"regex_pattern","provider_config_key":"aws","expressions":{"name":{"references":["var.client","var.functionality","var.environment","each.value[\"rule_name\"]","each.value"]},"scope":{"references":["each.value[\"scope\"]","each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.waf_config"]}},{"address":"aws_wafv2_web_acl.waf","mode":"managed","type":"aws_wafv2_web_acl","name":"waf","provider_config_key":"aws","expressions":{"default_action":[{}],"description":{"references":["each.value[\"description\"]","each.value"]},"name":{"references":["var.client","var.functionality","var.environment","each.key"]},"scope":{"references":["each.value[\"scope\"]","each.value"]},"tags":{"references":["var.client","var.functionality","var.environment","each.key","each.value.application","each.value"]},"visibility_config":[{"cloudwatch_metrics_enabled":{"references":["each.value[\"cloudwatch_metrics_enabled\"]","each.value"]},"metric_name":{"references":["var.client","var.functionality","var.environment","each.key"]},"sampled_requests_enabled":{"references":["each.value[\"sampled_requests_enabled\"]","each.value"]}}]},"schema_version":0,"for_each_expression":{"references":["var.waf_config"]}}],"variables":{"client":{},"environment":{},"functionality":{},"waf_config":{}}}}}}},"relevant_attributes":[{"resource":"module.waf.aws_wafv2_regex_pattern_set.regex_pattern","attribute":[]},{"resource":"module.waf.aws_wafv2_ip_set.ip_set","attribute":[]},{"resource":"module.waf.aws_wafv2_web_acl.waf","attribute":[]}],"timestamp":"2025-06-09T16:21:31Z","applyable":true,"complete":true,"errored":false}
